<!DOCTYPE html>
<html lang="en" class=""> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #ffffff; 
            --text-color: #000000; 
            --text-muted-color: #555555; 
            --primary-accent-color: #000000; 
            --primary-accent-hover-color: #333333; 
            
            --card-bg-color: rgba(230, 230, 230, 0.5); 
            --card-border-color: rgba(200, 200, 200, 0.2);
            --header-bg-color: rgba(245, 245, 245, 0.7); 
            
            --shadow-color-light: rgba(0,0,0,0.08);
            --shadow-color-medium: rgba(0,0,0,0.05);
            
            --icon-folder-color: #555555; 
            --icon-file-color: #555555; 
            
            --pre-bg-color: #f0f0f0; 
            --pre-text-color: #000000;
            
            --font-code: Consolas, 'Courier New', Courier, monospace;

            --glow-color: rgba(0, 0, 0, 0.7); 
            --glow-color-intense: rgba(0, 0, 0, 1);
        }

        html.dark {
            --bg-color: #000000; 
            --text-color: #ffffff; 
            --text-muted-color: #aaaaaa; 
            --primary-accent-color: #ffffff; 
            --primary-accent-hover-color: #dddddd; 

            --card-bg-color: rgba(25, 25, 25, 0.5); 
            --card-border-color: rgba(50, 50, 50, 0.3);
            --header-bg-color: rgba(15, 15, 15, 0.7); 

            --shadow-color-light: rgba(255,255,255,0.05);
            --shadow-color-medium: rgba(255,255,255,0.03);

            --icon-folder-color: #aaaaaa;
            --icon-file-color: #aaaaaa;

            --pre-bg-color: #1a1a1a; 
            --pre-text-color: #ffffff;

            --glow-color: rgba(255, 255, 255, 0.7); 
            --glow-color-intense: rgba(255, 255, 255, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .frosted-glass {
            background-color: var(--card-bg-color);
            backdrop-filter: blur(10px) saturate(120%); 
            -webkit-backdrop-filter: blur(10px) saturate(120%);
            border: 1px solid var(--card-border-color);
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px var(--shadow-color-light), 0 2px 4px -1px var(--shadow-color-medium);
        }
        .header-frosted {
            background-color: var(--header-bg-color);
            backdrop-filter: blur(12px) saturate(150%);
            -webkit-backdrop-filter: blur(12px) saturate(150%);
            box-shadow: 0 2px 10px var(--shadow-color-light);
        }
        
        /* Tab Navigation Styling */
        nav.main-nav {
            position: relative; /* Container for the underline */
            display: flex;
        }
        .tab { 
            color: var(--text-muted-color); 
            background-color: transparent; /* Tabs are transparent */
            border: none; /* No button border */
            padding: 0.75rem 1rem; /* Adjust padding as needed */
            margin: 0 0.25rem; /* Space between tabs */
            cursor: pointer;
            font-weight: 500;
            outline: none;
            position: relative; /* Needed for z-index if overlap occurs with underline */
            transition: color 0.3s ease;
        }
        .tab:hover { 
            color: var(--primary-accent-color);
        }
        .tab.tab-active-text { /* Class for the text of the active tab */
            color: var(--primary-accent-color) !important;
            font-weight: 700;
        }
        #active-tab-underline {
            position: absolute;
            bottom: 0px; /* Position at the bottom of the nav */
            height: 3px; /* Thickness of the underline */
            background-color: var(--primary-accent-color);
            border-radius: 1.5px; /* Rounded ends for the underline */
            box-shadow: 0 0 12px 2px var(--glow-color-intense); /* Glow effect */
            transition: left 0.3s cubic-bezier(0.65, 0, 0.35, 1), width 0.3s cubic-bezier(0.65, 0, 0.35, 1); /* Smooth animation */
            z-index: 0;
        }
        

        .document-item {
            display: flex; align-items: center; padding: 0.5rem 0.75rem;
            border-radius: 0.375rem; cursor: pointer; transition: background-color 0.2s, color 0.2s;
            color: var(--text-color);
        }
        .document-item:hover { 
            background-color: var(--card-bg-color); 
            color: var(--primary-accent-color);
        }
        .document-item svg { margin-right: 0.5rem; width: 1.25rem; height: 1.25rem; flex-shrink: 0; }
        .document-item .icon-folder { color: var(--icon-folder-color); }
        .document-item .icon-file { color: var(--icon-file-color); }
        .document-item-name { flex-grow: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Styles for content rendered by Marked.js */
        .document-content-viewer {
            background-color: var(--card-bg-color); border-radius: 0.5rem; padding: 1.5rem;
            min-height: 300px; box-shadow: 0 4px 6px -1px var(--shadow-color-light), 0 2px 4px -1px var(--shadow-color-medium);
            color: var(--text-color);
            line-height: 1.7; 
        }
        .document-content-viewer > *:first-child { margin-top: 0; } 
        .document-content-viewer > *:last-child { margin-bottom: 0; } 

        .document-content-viewer pre {
            background-color: var(--pre-bg-color); color: var(--pre-text-color);
            padding: 1em; border-radius: 0.375rem; overflow-x: auto;
            font-family: var(--font-code);
            font-size: 0.9em;
            line-height: 1.45;
            margin-top: 1em;
            margin-bottom: 1em;
        }
        .document-content-viewer code:not(pre code) { 
            font-family: var(--font-code);
            background-color: var(--pre-bg-color); 
            color: var(--pre-text-color);
            padding: 0.2em 0.4em;
            border-radius: 0.25em;
            font-size: 0.9em;
        }
        .document-content-viewer h1, 
        .document-content-viewer h2, 
        .document-content-viewer h3,
        .document-content-viewer h4,
        .document-content-viewer h5,
        .document-content-viewer h6 { 
            font-weight: 600; 
            margin-top: 1.5em; 
            margin-bottom: 0.75em; 
            line-height: 1.3;
            color: var(--text-color); 
        }
        .document-content-viewer h1 { font-size: 2em; } 
        .document-content-viewer h2 { font-size: 1.6em; } 
        .document-content-viewer h3 { font-size: 1.3em; }
        .document-content-viewer h4 { font-size: 1.1em; }
        .document-content-viewer p { margin-bottom: 1em; }
        
        /* Improved List Styling for Markdown */
        .document-content-viewer ul, 
        .document-content-viewer ol {
            margin-left: 0; /* Remove default browser margin */
            padding-left: 1.75em; /* Indent the whole list block for the bullet/number */
            margin-bottom: 1em;
        }
        .document-content-viewer li {
            margin-bottom: 0.5em; 
            /* padding-left: 0.5em; Removed: padding on ul/ol handles overall indent */
            position: relative; 
        }
        .document-content-viewer li > p:first-child {
             margin-top: 0; /* Remove top margin from first paragraph inside a list item if Marked.js wraps content in <p> */
        }
        .document-content-viewer li > p:last-child {
             margin-bottom: 0; /* Remove bottom margin from last paragraph inside a list item */
        }
        .document-content-viewer ul { list-style-type: disc; }
        .document-content-viewer ol { list-style-type: decimal; }
        
        .document-content-viewer ul ul, 
        .document-content-viewer ol ol,
        .document-content-viewer ul ol,
        .document-content-viewer ol ul {
            margin-left: 1.5em; /* Further indent nested lists */
            margin-top: 0.4em; 
            margin-bottom: 0.4em; 
        }
        .document-content-viewer blockquote {
            border-left: 4px solid var(--primary-accent-color);
            padding-left: 1em;
            margin-left: 0;
            margin-right: 0;
            margin-top: 1em;
            margin-bottom: 1em;
            font-style: italic;
            color: var(--text-muted-color);
        }
        .document-content-viewer hr {
            border: 0;
            height: 1px;
            background-color: var(--card-border-color);
            margin-top: 2em;
            margin-bottom: 2em;
        }

        /* MathJax Styling */
        mjx-container { 
            display: inline-block; 
            line-height: 0; 
            text-align: left; 
            vertical-align: baseline; 
            margin: 0 0.15em; 
        }
        mjx-container[display="true"] { 
            display: block; 
            overflow-x: auto; 
            overflow-y: hidden;
            margin: 1em 0; 
            line-height: normal; 
            text-align: center; 
        }
        
        .breadcrumb-item { cursor: pointer; color: var(--primary-accent-color); }
        .breadcrumb-item:hover { text-decoration: underline; }
        .breadcrumb-separator { margin: 0 0.5rem; color: var(--text-muted-color); }

        .theme-switch-wrapper { display: flex; align-items: center; }
        .theme-switch { display: inline-block; height: 24px; position: relative; width: 44px; margin-left: 1rem; }
        .theme-switch input { display:none; }
        .slider {
            background-color: #ccc; bottom: 0; cursor: pointer; left: 0; position: absolute; right: 0; top: 0;
            transition: .4s; border-radius: 24px;
            box-shadow: 0 0 5px 0px var(--glow-color); 
        }
        html.dark .slider { background-color: #333; }
        .slider:before {
            background-color: var(--bg-color); 
            bottom: 3px; content: ""; height: 18px; left: 3px; position: absolute;
            transition: .4s; width: 18px; border-radius: 50%;
            box-shadow: 0 0 5px 1px var(--glow-color-intense); 
        }
        input:checked + .slider { background-color: var(--primary-accent-color); }
        input:checked + .slider:before { transform: translateX(20px); }
    </style>
</head>
<body>
    <header class="header-frosted sticky top-0 z-40">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <h1 id="userName" class="text-2xl sm:text-3xl font-bold" style="color: var(--primary-accent-color);"></h1>
            <nav class="main-nav flex items-center relative">
                <button onclick="showSection('home', this)" class="tab" data-tab="home">Home</button>
                <button onclick="showSection('documents', this)" class="tab" data-tab="documents">Documents</button>
                <span id="active-tab-underline"></span>
                <div class="theme-switch-wrapper ml-4"> <label class="theme-switch" for="themeToggleCheckbox">
                        <input type="checkbox" id="themeToggleCheckbox" />
                        <span class="slider"></span>
                    </label>
                </div>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 py-8">
        <section id="home" class="content-section">
            <div class="frosted-glass p-6 sm:p-8">
                <h2 class="text-2xl sm:text-3xl font-semibold mb-6">About Me</h2>
                <div id="personalInfoContent" class="space-y-4"></div>
            </div>
        </section>

        <section id="documents" class="content-section hidden">
            <div class="frosted-glass p-6 sm:p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl sm:text-3xl font-semibold">My Documents</h2>
                </div>
                <div id="breadcrumbsContainer" class="mb-4 text-sm flex items-center"></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div id="documentNavigation" class="md:col-span-1 p-4 rounded-lg shadow-inner" style="background-color: rgba(0,0,0,0.03);">
                        <h3 class="text-lg font-medium mb-3">Explorer</h3>
                        <div id="documentListContainer" class="space-y-1"></div>
                    </div>
                    <div id="documentViewer" class="md:col-span-2">
                        <div id="documentContentViewer" class="document-content-viewer min-h-[400px]">
                            <p class="italic" style="color: var(--text-muted-color);">Select a file to view its content. Document structure is loaded from documents_manifest.json.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-10 text-sm" style="color: var(--text-muted-color);">
        <p>&copy; <span id="currentYear"></span> <span id="footerName"></span>. All rights reserved.</p>
    </footer>

    <script>
        // --- Default Static User Configuration (Fallback for config.json) ---
        let siteConfig = {
            userName: "Your Name (Default)",
            footerName: "Your Name (Default)",
            personalInfoHTML: `
                <p>Welcome to my personal page! (Default Info)</p>
                <p>To customize this, create 'config.json' next to this HTML file.</p>
            `
        };

        // --- MathJax Configuration ---
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true },
            svg: { fontCache: 'global' }
        };

        // --- Global Variables & DOM Elements ---
        const sections = { home: document.getElementById('home'), documents: document.getElementById('documents') };
        const tabs = document.querySelectorAll('.tab'); // Get all tab buttons
        const activeTabUnderline = document.getElementById('active-tab-underline');
        const userNameElement = document.getElementById('userName');
        const footerNameElement = document.getElementById('footerName');
        const currentYearElement = document.getElementById('currentYear');
        const themeToggle = document.getElementById('themeToggleCheckbox');
        const htmlElement = document.documentElement;
        
        const personalInfoContent = document.getElementById('personalInfoContent');
        const documentListContainer = document.getElementById('documentListContainer');
        const documentContentViewer = document.getElementById('documentContentViewer');
        const breadcrumbsContainer = document.getElementById('breadcrumbsContainer');

        let documentsData = []; 
        let currentFolderId = null; 

        const fallbackDocumentStructure = [ 
            {
                id: 'docs_root_fallback', 
                type: 'folder',
                name: 'Documents (Fallback)', 
                children: [
                    { id: 'fallback_info_file', type: 'file', name: 'ManifestInfo.md', content: '# Document Manifest Not Loaded\n\nPlease ensure `documents_manifest.json` exists in the same directory as `index.html` and is correctly formatted. This file defines the folder and file structure for the Documents section.' }
                ]
            }
        ];
        
        const folderIconSVG = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="icon-folder">
                <path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" />
            </svg>`;
        const fileIconSVG = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="icon-file">
                <path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V7.414A2 2 0 0017.414 6L12 1.586A2 2 0 0010.586 1H4zm6 10a1 1 0 10-2 0v3a1 1 0 102 0v-3zm2-3a1 1 0 011 1v5a1 1 0 11-2 0v-5a1 1 0 011-1z" clip-rule="evenodd" />
            </svg>`;

        async function initializeApp() {
            initializeTheme();
            await loadSiteConfig(); 
            await initializeDocumentsData(); 
            
            marked.setOptions({
                breaks: true, 
                gfm: true,      
                pedantic: false 
            });
            
            // Set initial active tab and underline position
            const initialActiveTab = document.querySelector('.tab[data-tab="home"]'); // Default to home
            if (initialActiveTab) {
                updateActiveTab(initialActiveTab);
            }
            showSection('home', initialActiveTab); // Pass the element for initial underline positioning


            currentYearElement.textContent = new Date().getFullYear();
            themeToggle.addEventListener('change', toggleTheme);
        }
        
        document.addEventListener('DOMContentLoaded', initializeApp);

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                htmlElement.classList.add('dark');
                themeToggle.checked = true;
            } else {
                htmlElement.classList.remove('dark');
                themeToggle.checked = false;
            }
        }
        function toggleTheme() {
            if (themeToggle.checked) {
                htmlElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                htmlElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            }
        }

        async function loadSiteConfig() {
            try {
                const response = await fetch('config.json');
                if (response.ok) {
                    const configFromFile = await response.json();
                    siteConfig = { ...siteConfig, ...configFromFile };
                    console.log("Successfully loaded config.json");
                } else {
                    console.warn("config.json not found or couldn't be loaded. Using default site configuration. Status:", response.status);
                }
            } catch (error) {
                console.warn("Error fetching config.json. Using default site configuration.", error);
            }
            setStaticUserInfo();
        }

        function setStaticUserInfo() {
            userNameElement.textContent = siteConfig.userName;
            footerNameElement.textContent = siteConfig.footerName;
            personalInfoContent.innerHTML = siteConfig.personalInfoHTML; 
            if (window.MathJax && window.MathJax.typesetPromise) { 
                MathJax.typesetPromise([personalInfoContent]).catch(err => console.error('MathJax error on personal info:', err));
            }
        }
        
        function updateActiveTab(activeTabElement) {
            tabs.forEach(t => t.classList.remove('tab-active-text'));
            if (activeTabElement) {
                activeTabElement.classList.add('tab-active-text');
                activeTabUnderline.style.left = activeTabElement.offsetLeft + 'px';
                activeTabUnderline.style.width = activeTabElement.offsetWidth + 'px';
            } else { // Hide underline if no tab is active (should not happen in this setup)
                activeTabUnderline.style.width = '0px';
            }
        }

        function showSection(sectionId, clickedTabElement) {
            Object.values(sections).forEach(s => s.classList.add('hidden'));
            if (sections[sectionId]) sections[sectionId].classList.remove('hidden');
            
            updateActiveTab(clickedTabElement); // Update underline and text style

            if (sectionId === 'documents') {
                if (!currentFolderId && documentsData.length > 0 && documentsData[0].type === 'folder') {
                     currentFolderId = documentsData[0].id; 
                }
                renderDocumentNavigation();
                renderBreadcrumbs();
            }
        }
        
        function generateId() { return '_' + Math.random().toString(36).substr(2, 9); }

        function flattenStructure(items, parentId = null) {
            let flatList = [];
            items.forEach(item => {
                const id = item.id || generateId(); 
                const currentItem = { ...item, id, parentId, children: undefined }; 
                flatList.push(currentItem);
                if (item.children && item.type === 'folder') {
                    flatList = flatList.concat(flattenStructure(item.children, id));
                }
            });
            return flatList;
        }

        async function initializeDocumentsData() {
            let structureToFlatten = fallbackDocumentStructure;
            try {
                const response = await fetch('documents_manifest.json');
                if (response.ok) {
                    const manifestStructure = await response.json();
                    if (manifestStructure && manifestStructure.length > 0) {
                        structureToFlatten = manifestStructure;
                        console.log("Successfully loaded documents_manifest.json");
                    } else {
                        console.warn("documents_manifest.json is empty or invalid. Using fallback structure.");
                    }
                } else {
                    console.warn("documents_manifest.json not found. Using fallback structure. Status:", response.status);
                }
            } catch (error) {
                console.warn("Error fetching documents_manifest.json. Using fallback structure.", error);
            }
            documentsData = flattenStructure(structureToFlatten);
            if (documentsData.length > 0 && documentsData[0].type === 'folder') {
                currentFolderId = documentsData[0].id;
            } else {
                currentFolderId = null; 
            }
        }

        function renderDocumentNavigation() {
            documentListContainer.innerHTML = '';
            const itemsInCurrentFolder = documentsData.filter(item => item.parentId === currentFolderId);

            if (itemsInCurrentFolder.length === 0) {
                 const currentFolderObj = documentsData.find(item => item.id === currentFolderId);
                 if (currentFolderObj) { 
                    documentListContainer.innerHTML = `<p class="text-sm px-2" style="color: var(--text-muted-color);">This folder is empty.</p>`;
                 } else { 
                    documentListContainer.innerHTML = `<p class="text-sm px-2" style="color: var(--text-muted-color);">No documents to display. Check documents_manifest.json.</p>`;
                 }
                 return;
            }

            itemsInCurrentFolder.sort((a, b) => {
                if (a.type === 'folder' && b.type === 'file') return -1;
                if (a.type === 'file' && b.type === 'folder') return 1;
                return a.name.localeCompare(b.name);
            });

            itemsInCurrentFolder.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'document-item group';
                itemDiv.setAttribute('data-id', item.id);
                itemDiv.setAttribute('data-type', item.type);
                const icon = item.type === 'folder' ? folderIconSVG : fileIconSVG;
                const nameSpan = `<span class="document-item-name">${item.name}</span>`;
                itemDiv.innerHTML = `${icon} ${nameSpan}`;
                itemDiv.onclick = () => handleItemClick(item.id, item.type);
                documentListContainer.appendChild(itemDiv);
            });
        }
        
        async function renderDocumentContent(fileId) {
            const file = documentsData.find(item => item.id === fileId && item.type === 'file');
            if (file) {
                let markdownContent = "";
                documentContentViewer.innerHTML = `<p class="italic" style="color: var(--text-muted-color);">Loading content...</p>`; 

                if (file.path) { 
                    try {
                        const response = await fetch(file.path);
                        if (response.ok) {
                            markdownContent = await response.text();
                        } else {
                            markdownContent = `# Error\n\nCould not load file from: ${file.path}\nStatus: ${response.status}`;
                            console.error(`Failed to fetch ${file.path}: ${response.status}`);
                        }
                    } catch (error) {
                        markdownContent = `# Error\n\nCould not load file from: ${file.path}\nException: ${error}`;
                        console.error(`Error fetching ${file.path}:`, error);
                    }
                } else if (typeof file.content !== 'undefined') { 
                    markdownContent = file.content;
                } else {
                    markdownContent = "# Error\n\nFile has no path or embedded content defined in manifest.";
                }
                
                documentContentViewer.innerHTML = marked.parse(markdownContent);

                if (window.MathJax && window.MathJax.typesetPromise) {
                    MathJax.typesetPromise([documentContentViewer])
                        .catch(err => console.error('MathJax typesetting error after marked.parse:', err));
                } else if (window.MathJax) { 
                     MathJax.typeset([documentContentViewer]);
                }

            } else {
                documentContentViewer.innerHTML = `<p class="italic" style="color: var(--text-muted-color);">File not found in manifest.</p>`;
            }
        }
        
        function getFolderPath(folderId) {
            const path = [];
            let currentId = folderId;
            const rootFolderFromManifest = (documentsData.length > 0 && documentsData[0].type === 'folder') ? documentsData[0] : null;

            while (currentId) {
                const folder = documentsData.find(item => item.id === currentId && item.type === 'folder');
                if (folder) {
                    path.unshift(folder);
                    if (rootFolderFromManifest && folder.id === rootFolderFromManifest.id) break; 
                    currentId = folder.parentId;
                    if (!currentId && folder.id !== (rootFolderFromManifest ? rootFolderFromManifest.id : null)) break;
                } else {
                    break; 
                }
            }
            return path;
        }

        function renderBreadcrumbs() {
            breadcrumbsContainer.innerHTML = '';
            const rootDocsFolder = (documentsData.length > 0 && documentsData[0].type === 'folder') ? documentsData[0] : null;
            
            if (!rootDocsFolder) { 
                breadcrumbsContainer.innerHTML = `<span style="color: var(--text-muted-color);">Documents</span>`;
                return;
            }

            const rootLink = document.createElement('span');
            rootLink.textContent = rootDocsFolder.name; 
            rootLink.className = 'breadcrumb-item font-medium';
            rootLink.onclick = () => {
                currentFolderId = rootDocsFolder.id;
                renderDocumentNavigation();
                renderBreadcrumbs(); 
                clearDocumentViewer();
            };
            breadcrumbsContainer.appendChild(rootLink);

            if (currentFolderId && currentFolderId !== rootDocsFolder.id) {
                const path = getFolderPath(currentFolderId); 
                let pathFromRootDocuments = [];
                let foundRoot = false;
                for(let i=0; i < path.length; i++){
                    if(path[i].id === rootDocsFolder.id) {
                        foundRoot = true;
                        continue; 
                    }
                    if(foundRoot){
                         pathFromRootDocuments.push(path[i]);
                    }
                }
                pathFromRootDocuments.forEach(folder => {
                    const separator = document.createElement('span');
                    separator.className = 'breadcrumb-separator';
                    separator.textContent = '>';
                    breadcrumbsContainer.appendChild(separator);

                    const folderLink = document.createElement('span');
                    folderLink.textContent = folder.name;
                    folderLink.className = 'breadcrumb-item';
                    folderLink.onclick = () => {
                        currentFolderId = folder.id;
                        renderDocumentNavigation();
                        renderBreadcrumbs();
                        clearDocumentViewer();
                    };
                    breadcrumbsContainer.appendChild(folderLink);
                });
            }
        }
        
        function clearDocumentViewer() {
            documentContentViewer.innerHTML = `<p class="italic" style="color: var(--text-muted-color);">Select a file to view its content. Document structure is loaded from documents_manifest.json.</p>`;
        }

        function handleItemClick(itemId, itemType) {
            if (itemType === 'folder') {
                currentFolderId = itemId;
                renderDocumentNavigation();
                renderBreadcrumbs();
                clearDocumentViewer();
            } else if (itemType === 'file') {
                renderDocumentContent(itemId); 
            }
        }
    </script>
</body>
</html>
